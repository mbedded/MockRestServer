<html>
<head>
    <link rel="stylesheet" type="text/css" href="/assets/style.css">
    <script src="/assets/jquery-3.5.1.min.js" type="text/javascript"></script>
</head>
<body>
<h1>Show all Mocks</h1>

<p>Here you see all your mocks you have created.</p>

<table>
    <thead>
    <tr>
        <th>Key</th>
        <th>Content</th>
        <th></th>
        <th></th>
    </tr>
    </thead>
    <tbody id="tableContent">

    </tbody>
</table>

<a href="/">Back to home</a>

<script>
    var tableContent = $("#tableContent");

    function createTable(mocks) {
        var rows = [mocks.length];

        for (let index = 0; index < mocks.length; index++) {
            var item = mocks[index];

            var content = item.Content.substring(0, 20);

            var content = `
                    <tr>
                        <td>${item.Key}</td>
                        <td>${content}</td>
                        <td><a href=\'/create?key=${item.Key}\'>Edit</a></td>
                        <td><a href=\'/raw/${item.Key}\'>Raw</a></td>
                    </tr>`;

            rows[index] = content;
        }

        var complete = rows.join();
        tableContent.html(complete);
    }

    $(function () {
        $.ajax({
            type: "GET",
            url: '/api/mock/all',
            success: function (data) {
                const result = JSON.parse(data);

                createTable(result);
            },
            error: function (errMsg) {
                $.notify(`Error reading all mocks.\r\n${errMsg.responseText}`, "error");
            }
        })
    });
</script>
</body>
</html>
